module Test (tests) where

import Matrix
import Test.HUnit
import qualified Data.Map as M


tests :: IO ()
tests =  runTestTTAndExit . test  $ [
  "Matrix size test" ~: "Simple test" ~: (size . Matrix $ [[2,3],[4,5]]) ~=? (2,2),

  "rowInc test" ~: "Property test" ~: (let m = Matrix [[(2,3),(4,8)],[(7,3),(4,5)]]
                                       in (fmap ((rowInc 1) . (rowInc (-1))) m) ~=? m),

  "colInc test" ~: "Property test" ~: (let m = Matrix [[(2,3),(4,8)],[(7,3),(4,5)]]
                                       in (fmap ((colInc 1) . (colInc (-1))) m) ~=? m),

  "indexMatrix test" ~: "generation of 2x2" ~: (indexMatrix (2,2)) ~=? (Matrix [[(0,0),(0,1)],
                                                                                [(1,0),(1,1)]]),

  "indexMatrix test" ~: "generation of 3x3" ~: (indexMatrix (3,3)) ~=? (Matrix [[(0,0),(0,1),(0,2)],
                                                                                [(1,0),(1,1),(1,2)],
                                                                                [(2,0),(2,1),(2,2)]]),

  "matrix traversal test" ~: "one step traversal" ~:  (matrixTraversal (indexMatrix (3,3)) (1,1)) ~=? [(1,1)],

  "matrix traversal test" ~: "more complicated test" ~:  (matrixTraversal (indexMatrix (8,8)) (2,2)) ~=? [(2,2),(2,3),(2,4),(2,5),
                                                                                                          (3,2),(3,3),(3,4),(3,5),
                                                                                                          (4,2),(4,3),(4,4),(4,5),
                                                                                                          (5,2),(5,3),(5,4),(5,5)],
  "pointToMatrix test 1" ~: " 3x3 test" ~: (pointToMatrix (2,3) (3,3)) ~=? (Matrix [[(1,2), (1,3), (1,4)],
                                                                                   [(2,2), (2,3), (2,4)],
                                                                                   [(3,2), (3,3), (3,4)]]),

  "pointToMatrix test 2" ~: " 5x5 test" ~: (pointToMatrix (7,3) (5,5)) ~=? (Matrix [[(5,1), (5,2), (5,3), (5,4), (5,5)],
                                                                                    [(6,1), (6,2), (6,3), (6,4), (6,5)],
                                                                                    [(7,1), (7,2), (7,3), (7,4), (7,5)],
                                                                                    [(8,1), (8,2), (8,3), (8,4), (8,5)],
                                                                                    [(9,1), (9,2), (9,3), (9,4), (9,5)]]),

  "mysteryFunction test" ~: " " ~: (mysteryFunction (indexMatrix (8,8)) (3,3)) ~=? (M.fromList [
                                                                                       ((1,1),Matrix [[(0,0),(0,1),(0,2)],
                                                                                                      [(1,0),(1,1),(1,2)],
                                                                                                      [(2,0),(2,1),(2,2)]]),
                                                                                        ((1,2),Matrix [[(0,1),(0,2),(0,3)],
                                                                                                       [(1,1),(1,2),(1,3)],
                                                                                                       [(2,1),(2,2),(2,3)]]),
                                                                                        ((1,3),Matrix [[(0,2),(0,3),(0,4)],
                                                                                                       [(1,2),(1,3),(1,4)],
                                                                                                       [(2,2),(2,3),(2,4)]]),
                                                                                         ((1,4),Matrix [[(0,3),(0,4),(0,5)],
                                                                                                        [(1,3),(1,4),(1,5)],
                                                                                                        [(2,3),(2,4),(2,5)]]),
                                                                                         ((1,5),Matrix [[(0,4),(0,5),(0,6)],
                                                                                                        [(1,4),(1,5),(1,6)],
                                                                                                        [(2,4),(2,5),(2,6)]]),
                                                                                         ((1,6),Matrix [[(0,5),(0,6),(0,7)],
                                                                                                        [(1,5),(1,6),(1,7)],
                                                                                                        [(2,5),(2,6),(2,7)]]),
                                                                                         ((2,1),Matrix [[(1,0),(1,1),(1,2)],
                                                                                                        [(2,0),(2,1),(2,2)],
                                                                                                        [(3,0),(3,1),(3,2)]]),
                                                                                         ((2,2),Matrix [[(1,1),(1,2),(1,3)],
                                                                                                        [(2,1),(2,2),(2,3)],
                                                                                                        [(3,1),(3,2),(3,3)]]),
                                                                                         ((2,3),Matrix [[(1,2),(1,3),(1,4)],
                                                                                                        [(2,2),(2,3),(2,4)],
                                                                                                        [(3,2),(3,3),(3,4)]]),((2,4),Matrix [[(1,3),(1,4),(1,5)],[(2,3),(2,4),(2,5)],[(3,3),(3,4),(3,5)]]),((2,5),Matrix [[(1,4),(1,5),(1,6)],[(2,4),(2,5),(2,6)],[(3,4),(3,5),(3,6)]]),((2,6),Matrix [[(1,5),(1,6),(1,7)],[(2,5),(2,6),(2,7)],[(3,5),(3,6),(3,7)]]),((3,1),Matrix [[(2,0),(2,1),(2,2)],[(3,0),(3,1),(3,2)],[(4,0),(4,1),(4,2)]]),((3,2),Matrix [[(2,1),(2,2),(2,3)],[(3,1),(3,2),(3,3)],[(4,1),(4,2),(4,3)]]),((3,3),Matrix [[(2,2),(2,3),(2,4)],[(3,2),(3,3),(3,4)],[(4,2),(4,3),(4,4)]]),((3,4),Matrix [[(2,3),(2,4),(2,5)],[(3,3),(3,4),(3,5)],[(4,3),(4,4),(4,5)]]),((3,5),Matrix [[(2,4),(2,5),(2,6)],[(3,4),(3,5),(3,6)],[(4,4),(4,5),(4,6)]]),((3,6),Matrix [[(2,5),(2,6),(2,7)],[(3,5),(3,6),(3,7)],[(4,5),(4,6),(4,7)]]),((4,1),Matrix [[(3,0),(3,1),(3,2)],[(4,0),(4,1),(4,2)],[(5,0),(5,1),(5,2)]]),((4,2),Matrix [[(3,1),(3,2),(3,3)],[(4,1),(4,2),(4,3)],[(5,1),(5,2),(5,3)]]),((4,3),Matrix [[(3,2),(3,3),(3,4)],[(4,2),(4,3),(4,4)],[(5,2),(5,3),(5,4)]]),((4,4),Matrix [[(3,3),(3,4),(3,5)],[(4,3),(4,4),(4,5)],[(5,3),(5,4),(5,5)]]),((4,5),Matrix [[(3,4),(3,5),(3,6)],[(4,4),(4,5),(4,6)],[(5,4),(5,5),(5,6)]]),((4,6),Matrix [[(3,5),(3,6),(3,7)],[(4,5),(4,6),(4,7)],[(5,5),(5,6),(5,7)]]),((5,1),Matrix [[(4,0),(4,1),(4,2)],[(5,0),(5,1),(5,2)],[(6,0),(6,1),(6,2)]]),((5,2),Matrix [[(4,1),(4,2),(4,3)],[(5,1),(5,2),(5,3)],[(6,1),(6,2),(6,3)]]),((5,3),Matrix [[(4,2),(4,3),(4,4)],[(5,2),(5,3),(5,4)],[(6,2),(6,3),(6,4)]]),((5,4),Matrix [[(4,3),(4,4),(4,5)],[(5,3),(5,4),(5,5)],[(6,3),(6,4),(6,5)]]),((5,5),Matrix [[(4,4),(4,5),(4,6)],[(5,4),(5,5),(5,6)],[(6,4),(6,5),(6,6)]]),((5,6),Matrix [[(4,5),(4,6),(4,7)],[(5,5),(5,6),(5,7)],[(6,5),(6,6),(6,7)]]),((6,1),Matrix [[(5,0),(5,1),(5,2)],[(6,0),(6,1),(6,2)],[(7,0),(7,1),(7,2)]]),((6,2),Matrix [[(5,1),(5,2),(5,3)],[(6,1),(6,2),(6,3)],[(7,1),(7,2),(7,3)]]),((6,3),Matrix [[(5,2),(5,3),(5,4)],[(6,2),(6,3),(6,4)],[(7,2),(7,3),(7,4)]]),((6,4),Matrix [[(5,3),(5,4),(5,5)],[(6,3),(6,4),(6,5)],[(7,3),(7,4),(7,5)]]),((6,5),Matrix [[(5,4),(5,5),(5,6)],[(6,4),(6,5),(6,6)],[(7,4),(7,5),(7,6)]]),((6,6),Matrix [[(5,5),(5,6),(5,7)],[(6,5),(6,6),(6,7)],[(7,5),(7,6),(7,7)]])]
                                                                                        )
  ]

